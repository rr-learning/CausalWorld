

<!DOCTYPE html>
<html class="writer-html5" lang="python" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Task distributions &mdash; causal_rl_bench 1.0.0 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Evaluation Protocols" href="evaluating_policy.html" />
    <link rel="prev" title="Getting Started" href="getting_started.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> causal_rl_bench
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting Started</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Task distributions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#observation-spaces">Observation spaces</a></li>
<li class="toctree-l2"><a class="reference internal" href="#rewards-and-additional-information">Rewards and additional information</a></li>
<li class="toctree-l2"><a class="reference internal" href="#defining-your-own-task">Defining your own task</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="evaluating_policy.html">Evaluation Protocols</a></li>
</ul>
<p class="caption"><span class="caption-text">Contents</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../modules/causal_rl_bench.html">CausalRLBench</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">causal_rl_bench</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Task distributions</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/guide/task_setups.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="task-distributions">
<span id="task-setups"></span><h1>Task distributions<a class="headerlink" href="#task-distributions" title="Permalink to this headline">¶</a></h1>
<a class="reference internal image-reference" href="../_images/demo_pushing.gif"><img alt="Pushing - single cuboid" class="align-left" src="../_images/demo_pushing.gif" style="width: 204.8px; height: 163.84px;" /></a>
<a class="reference internal image-reference" href="../_images/demo_picking.gif"><img alt="Picking - single cuboid" class="align-left" src="../_images/demo_picking.gif" style="width: 204.8px; height: 163.84px;" /></a>
<a class="reference internal image-reference" href="../_images/demo_pick_and_place.gif"><img alt="Pick and Place - single cuboid" class="align-left" src="../_images/demo_pick_and_place.gif" style="width: 204.8px; height: 163.84px;" /></a>
<a class="reference internal image-reference" href="../_images/demo_towers.gif"><img alt="Towers - multiple cuboids" class="align-left" src="../_images/demo_towers.gif" style="width: 204.8px; height: 163.84px;" /></a>
<a class="reference internal image-reference" href="../_images/demo_general.gif"><img alt="General constellation - multiple cuboids" class="align-left" src="../_images/demo_general.gif" style="width: 204.8px; height: 163.84px;" /></a>
<a class="reference internal image-reference" href="../_images/demo_stacked_blocks.gif"><img alt="Stacked Blocks - multiple cuboids" class="align-left" src="../_images/demo_stacked_blocks.gif" style="width: 204.8px; height: 163.84px;" /></a>
<a class="reference internal image-reference" href="../_images/demo_creative_stacked_blocks.gif"><img alt="Creative Stacked Blocks - multiple cuboids" class="align-left" src="../_images/demo_creative_stacked_blocks.gif" style="width: 204.8px; height: 163.84px;" /></a>
<p><br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /></p>
<p>CausalWorld comes with 8 task-distributions that range in difficulty from rather simple to extremely challenging.
All tasks follow a common goal formulation: Build a given 3D goal shape (visualizes in opaque green above) from
a given set of building blocks. By default each task-distribution that is passed to the CausalWorld environment
generates by default a fixed characteristic goal shape of this distribution with fixed initial building block poses.
Each task-generator exposes a complete set of
task-defining variables such that one can systematically change or randomize any aspect of interest during training
amd evaluation. Each task-generator comes with a default feature vector as observation space. Success within a given
environment can be measured at any time step using the fractional volumetric overlap of the tool_blocks with the
3D goal shapes.</p>
<table class="colwidths-given docutils align-default" id="id1">
<caption><span class="caption-text">Table of task-generators</span><a class="headerlink" href="#id1" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 25%" />
<col style="width: 75%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Task-generator</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Pushing</p></td>
<td><p>The goal is to move or push a single cuboid towards a goal pose, which is positioned on the arena floor.</p></td>
</tr>
<tr class="row-odd"><td><p>Picking</p></td>
<td><p>The goal is to pick up a single cuboid and hold it in a certain goal pose in the air above the initial pose.</p></td>
</tr>
<tr class="row-even"><td><p>Pick and Place</p></td>
<td><p>The goal is to pick up a single cuboid and place it behind a fixed barrier in a given goal pose on the arena floor.</p></td>
</tr>
<tr class="row-odd"><td><p>Towers</p></td>
<td><p>The goal is to build tower-shaped structures from a set of smaller cuboids under a give goal pose</p></td>
</tr>
<tr class="row-even"><td><p>Stacked Blocks</p></td>
<td><p>The goal is to build wall-like goal shapes from a set of smaller cuboids under a give goal pose.  The additional difficulty is that the goal poses' stability might be very sensitive to small inaccuracies in the structure</p></td>
</tr>
<tr class="row-odd"><td><p>Creative Stacked Blocks</p></td>
<td><p>The goal is to fill provided goal shapes from a set of smaller cuboids  The additional difficulty is that some goal shapes are in the air and an additional structure needs to be build from other cuboids to support stability.</p></td>
</tr>
<tr class="row-even"><td><p>General constellation</p></td>
<td><p>The goal is to restore a stable constellation of cuboids in the arena.</p></td>
</tr>
<tr class="row-odd"><td><p>Reaching</p></td>
<td><p>The goal is to reach three different positions in space. Note: This task does not fit into the target shape formulation from all the tasks above but is intended as a starter environment for testing your agent.</p></td>
</tr>
</tbody>
</table>
<div class="section" id="observation-spaces">
<h2>Observation spaces<a class="headerlink" href="#observation-spaces" title="Permalink to this headline">¶</a></h2>
<p>There are two default modes of observation spaces: 'cameras' and 'structured'</p>
<p>cameras: Three cameras are mounter around the trifinger robot pointing on the floor. In this mode the observations
after each time step are the three raw rgb images from these cameras showing the actual tool_blocks and fingers.
The goal shape is depicted in three additional rgb images in which the robot fingers are removed from the scene.
Images to be added here.</p>
<p>structured: In this mode the observation space is a lower-dimensional feature vector that is structured in the following order with the number of dimensions in parenthesis:
time left for task (1), joint_positions (9), joint_velocities (9), end_effector_positions (9). Then for each object in the
environment additional 29-dimensions are use representing: tool_block_type (1), tool_block_size (3), tool_block_cartesian_position (3),
tool_block_orientation (4), tool_block_linear_velocity (3), tool_block_angular_velocity (4),
goal_block_type (1), goal_block_size (3), goal_block_cartesian_position (3), goal_block_orientation (4).
Visualization of this layout to be added here.</p>
</div>
<div class="section" id="rewards-and-additional-information">
<h2>Rewards and additional information<a class="headerlink" href="#rewards-and-additional-information" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="defining-your-own-task">
<h2>Defining your own task<a class="headerlink" href="#defining-your-own-task" title="Permalink to this headline">¶</a></h2>
<p>You'd like to have another task-generator with fancy objects or goal shapes? Define your own task just as shown below!</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">causal_rl_bench.envs.causalworld</span> <span class="kn">import</span> <span class="n">CausalWorld</span>
<span class="kn">from</span> <span class="nn">causal_rl_bench.task_generators.base_task</span> <span class="kn">import</span> <span class="n">BaseTask</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>


<span class="k">class</span> <span class="nc">MyOwnTask</span><span class="p">(</span><span class="n">BaseTask</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">task_name</span><span class="o">=</span><span class="s2">&quot;new_task&quot;</span><span class="p">,</span>
                         <span class="n">use_train_space_only</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                         <span class="n">fractional_reward_weight</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                         <span class="n">dense_reward_weights</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_task_robot_observation_keys</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;time_left_for_task&quot;</span><span class="p">,</span>
                                             <span class="s2">&quot;joint_positions&quot;</span><span class="p">,</span>
                                             <span class="s2">&quot;joint_velocities&quot;</span><span class="p">,</span>
                                             <span class="s2">&quot;end_effector_positions&quot;</span><span class="p">]</span>

    <span class="c1">#This is not even needed, it will just be an empty stage</span>
    <span class="k">def</span> <span class="nf">_set_up_stage_arena</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1">#NOTE: you need to add rigid objects before silhouettes for determinism (pybullet limitation)</span>
        <span class="n">creation_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s2">&quot;tool_block&quot;</span><span class="p">,</span>
                         <span class="s1">&#39;filename&#39;</span><span class="p">:</span> <span class="s1">&#39;./assets/719.obj&#39;</span><span class="p">,</span>
                         <span class="s1">&#39;initial_position&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">]}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_stage</span><span class="o">.</span><span class="n">add_rigid_mesh_object</span><span class="p">(</span><span class="o">**</span><span class="n">creation_dict</span><span class="p">)</span>
        <span class="n">creation_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s2">&quot;goal_block&quot;</span><span class="p">,</span>
                         <span class="s1">&#39;filename&#39;</span><span class="p">:</span> <span class="s1">&#39;./assets/719.obj&#39;</span><span class="p">,</span>
                         <span class="s1">&#39;position&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">]}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_stage</span><span class="o">.</span><span class="n">add_silhoutte_mesh_object</span><span class="p">(</span><span class="o">**</span><span class="n">creation_dict</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_task_stage_observation_keys</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;tool_block_type&quot;</span><span class="p">,</span>
                                             <span class="s2">&quot;tool_block_size&quot;</span><span class="p">,</span>
                                             <span class="s2">&quot;tool_block_cartesian_position&quot;</span><span class="p">,</span>
                                             <span class="s2">&quot;tool_block_orientation&quot;</span><span class="p">,</span>
                                             <span class="s2">&quot;tool_block_linear_velocity&quot;</span><span class="p">,</span>
                                             <span class="s2">&quot;tool_block_angular_velocity&quot;</span><span class="p">,</span>
                                             <span class="s2">&quot;goal_block_type&quot;</span><span class="p">,</span>
                                             <span class="s2">&quot;goal_block_size&quot;</span><span class="p">,</span>
                                             <span class="s2">&quot;goal_block_cylindrical_position&quot;</span><span class="p">,</span>
                                             <span class="s2">&quot;goal_block_orientation&quot;</span><span class="p">]</span>
        <span class="k">return</span>


<span class="k">def</span> <span class="nf">example</span><span class="p">():</span>
    <span class="n">task</span> <span class="o">=</span> <span class="n">MyOwnTask</span><span class="p">()</span>
    <span class="n">env</span> <span class="o">=</span> <span class="n">CausalWorld</span><span class="p">(</span><span class="n">task</span><span class="o">=</span><span class="n">task</span><span class="p">,</span> <span class="n">enable_visualization</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">env</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2000</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
            <span class="n">obs</span><span class="p">,</span> <span class="n">reward</span><span class="p">,</span> <span class="n">done</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> \
                <span class="n">env</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">action_space</span><span class="o">.</span><span class="n">sample</span><span class="p">())</span>
        <span class="n">random_intervention_dict</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">do_single_random_intervention</span><span class="p">()</span>
    <span class="n">env</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">example</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="evaluating_policy.html" class="btn btn-neutral float-right" title="Evaluation Protocols" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="getting_started.html" class="btn btn-neutral float-left" title="Getting Started" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Ossama Ahmed and Frederik Trauble

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>